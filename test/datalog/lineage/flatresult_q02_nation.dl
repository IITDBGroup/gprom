PROV_NATION(N_KEY,N_NAME,R_KEY,X1) :-
    NATION(N_KEY,N_NAME,R_KEY,X1),
    REGION(R_KEY,'EUROPE',X2),
    SUPPLIER(S_KEY,S_NAME,S_ADDR,N_KEY,S_PHONE,S_ACCOUNT_BAL,S_COMMENT),
    PART(P_KEY,X3,P_MANU,X4,P_TYPE,15,X5,X6,X7),
    PARTSUPP(P_KEY,S_KEY,X8,S_COST,X9),
    Q2(P_KEY,S_COST),
    RTPCQ02(S_ACCOUNT_BAL,S_NAME,N_NAME,P_KEY,S_COST,P_MANU,S_ADDR,S_PHONE,S_COMMENT).

PROV_NATION(N_KEY,N_NAME,R_KEY,X1) :-
    NATION(N_KEY,N_NAME,R_KEY,X1),
    REGION(R_KEY,'EUROPE',X2),
    SUPPLIER(S_KEY,S_NAME,S_ADDR,N_KEY,S_PHONE,S_ACCOUNT_BAL,S_COMMENT),
    PART(P_KEY,X3,P_MANU,X4,P_TYPE,15,X5,X6,X7),
    PARTSUPP(P_KEY,S_KEY,X8,S_COST,X9),
    NATION(V10,N_NAME,V11,V12),
    REGION(V11,'EUROPE',V13),
    SUPPLIER(V14,S_NAME,S_ADDR,V10,S_PHONE,S_ACCOUNT_BAL,S_COMMENT),
    PART(P_KEY,V15,P_MANU,V16,V17,15,V18,V19,V20),
    PARTSUPP(P_KEY,V14,V21,S_COST,V22),
    NATION(V2,V3,V4,V5),
    REGION(V4,'EUROPE',V6),
    SUPPLIER(V7,V8,V23,V2,V24,V25,V26),
    PART(P_KEY,V27,V28,V29,V30,15,V31,V32,V33),
    PARTSUPP(P_KEY,V7,V34,V9,V35),
    Q2(P_KEY,V9),
    RTPCQ02(V25,V8,V3,P_KEY,V9,V28,V23,V24,V26).

Q2(P_KEY,min(S_COST)) :-
    Q1(X1,X2,X3,P_KEY,S_COST,X5,X6,X7,X8).

Q1(S_ACCOUNT_BAL,S_NAME,N_NAME,P_KEY,S_COST,P_MANU,S_ADDR,S_PHONE,S_COMMENT) :-
    NATION(N_KEY,N_NAME,R_KEY,X1),
    REGION(R_KEY,'EUROPE',X2),
    SUPPLIER(S_KEY,S_NAME,S_ADDR,N_KEY,S_PHONE,S_ACCOUNT_BAL,S_COMMENT),
    PART(P_KEY,X3,P_MANU,X4,P_TYPE,15,X5,X6,X7),
    PARTSUPP(P_KEY,S_KEY,X8,S_COST,X9).


ANS: prov_nation.

