Q(L_ORDERKEY,O_ORDERDATE,O_SHIPPRIORITY,sum((L_EXTENDEDPRICE * (1 - L_DISCOUNT)))) :- CUSTOMER(C_CUSTKEY,C1,C2,C3,C4,C5,'BUILDING',C6),ORDERS(L_ORDERKEY,C_CUSTKEY,O1,O2,O_ORDERDATE,O3,O4,O_SHIPPRIORITY,O5),LINEITEM(L_ORDERKEY,X1,X2,X3,X4,L_EXTENDEDPRICE,L_DISCOUNT,X5,X6,X7,L_SHIPDATE,X8,X9,X10,X11,X12),O_ORDERDATE < '1995-03-15',L_SHIPDATE > '1995-03-15'.

RP(X1,X2,X3,X4) :- RTPCQ03(X1,X2,X3,X4).

PROV_LINEITEM(L_ORDERKEY,X1,X2,X3,X4,L_EXTENDEDPRICE,L_DISCOUNT,X5,X6,X7,L_SHIPDATE,X8,X9,X10,X11,X12) :- CUSTOMER(C_CUSTKEY,C1,C2,C3,C4,C5,'BUILDING',C6),ORDERS(L_ORDERKEY,C_CUSTKEY,O1,O2,O_ORDERDATE,O3,O4,O_SHIPPRIORITY,O5),LINEITEM(L_ORDERKEY,X1,X2,X3,X4,L_EXTENDEDPRICE,L_DISCOUNT,X5,X6,X7,L_SHIPDATE,X8,X9,X10,X11,X12),O_ORDERDATE < '1995-03-15',L_SHIPDATE > '1995-03-15',RP(L_ORDERKEY,O_ORDERDATE,O_SHIPPRIORITY,V1).

ANS: PROV_LINEITEM.
