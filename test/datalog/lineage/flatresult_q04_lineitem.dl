Q1(L_OKEY) :- LINEITEM(L_OKEY,X1,X2,X3,X4,X5,X6,X7,X8,X9,X10,L_COMM_DATE,L_RECEIPT_DATE,X11,X12,X13),L_COMM_DATE < L_RECEIPT_DATE.

Q(O_OPRIORITY,count(1)) :- ORDERS(L_OKEY,X1,X2,X3,O_ODATE,O_OPRIORITY,X4,X5,X6),Q1(L_OKEY),O_ODATE >= '1993-07-01',O_ODATE < '1993-10-01'.

RP(X1,X2) :- RTPCQ04(X1,X2).

PROV_Q1(L_OKEY) :- ORDERS(L_OKEY,X1,X2,X3,O_ODATE,O_OPRIORITY,X4,X5,X6),Q1(L_OKEY),O_ODATE >= '1993-07-01',O_ODATE < '1993-10-01',RP(O_OPRIORITY,V1).

PROV_LINEITEM(L_OKEY,X1,X2,X3,X4,X5,X6,X7,X8,X9,X10,L_COMM_DATE,L_RECEIPT_DATE,X11,X12,X13) :- LINEITEM(L_OKEY,X1,X2,X3,X4,X5,X6,X7,X8,X9,X10,L_COMM_DATE,L_RECEIPT_DATE,X11,X12,X13),L_COMM_DATE < L_RECEIPT_DATE,PROV_Q1(L_OKEY).

ANS: PROV_LINEITEM.
