Q(N_N,sum((L_EP * (1 - L_D)))) :- CUSTOMER(C_CK,C1,C2,C_NK,C3,C4,C5,C6),ORDERS(O_OK,C_CK,O1,O2,O_OD,O3,O4,O5,O6),LINEITEM(O_OK,L1,L_SK,L2,L3,L_EP,L_D,L5,L6,L7,L8,L9,L10,L11,L12,L13),SUPPLIER(L_SK,S1,S2,C_NK,S3,S4,S5),NATION(C_NK,N_N,N_RK,N1),REGION(N_RK,'ASIA',R2),O_OD >= '1994-01-01',O_OD < '1995-01-01'.

RP(X1,X2) :- RTPCQ05(X1,X2).

PROV_LINEITEM(O_OK,L1,L_SK,L2,L3,L_EP,L_D,L5,L6,L7,L8,L9,L10,L11,L12,L13) :- CUSTOMER(C_CK,C1,C2,C_NK,C3,C4,C5,C6),ORDERS(O_OK,C_CK,O1,O2,O_OD,O3,O4,O5,O6),LINEITEM(O_OK,L1,L_SK,L2,L3,L_EP,L_D,L5,L6,L7,L8,L9,L10,L11,L12,L13),SUPPLIER(L_SK,S1,S2,C_NK,S3,S4,S5),NATION(C_NK,N_N,N_RK,N1),REGION(N_RK,'ASIA',R2),O_OD >= '1994-01-01',O_OD < '1995-01-01',RP(N_N,V1).

ANS: PROV_LINEITEM.
