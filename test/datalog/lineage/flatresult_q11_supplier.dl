QSUB1(PS_PK,sum((PS_SC * PS_AQ))) :- PARTSUPP(PS_PK,PS_SK,PS_AQ,PS_SC,PS2),SUPPLIER(PS_SK,S1,S2,S_NK,S3,S4,S5),NATION(S_NK,'GERMANY',N1,N2).

QSUB2(sum((C2 * 0.000100))) :- QSUB1(C1,C2).

Q(C1,C2) :- QSUB1(C1,C2),QSUB2(C3),((C2 > C3)).

RP(X1,X2) :- RTPCQ11(X1,X2).

PROV_QSUB1(C1,C2) :- QSUB1(C1,C2),PROV_QSUB2(V1).

PROV_QSUB1(C1,C2) :- QSUB1(C1,C2),QSUB2(C3),((C2 > C3)),RP(C1,C2).

PROV_QSUB2(C3) :- QSUB1(C1,C2),QSUB2(C3),((C2 > C3)),RP(C1,C2).

PROV_SUPPLIER(PS_SK,S1,S2,S_NK,S3,S4,S5) :- PARTSUPP(PS_PK,PS_SK,PS_AQ,PS_SC,PS2),SUPPLIER(PS_SK,S1,S2,S_NK,S3,S4,S5),NATION(S_NK,'GERMANY',N1,N2),PROV_QSUB1(PS_PK,V1).

ANS: PROV_SUPPLIER.
