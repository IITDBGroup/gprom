PROV_LINEITEM(L1,P_PARTKEY,L2,L3,L4,L_EXTP,L_DISCOUNT,L5,L6,L7,L_SHIPDATE,L8,L9,L10,L11,L12) :-
    PART(P_PARTKEY,P1,P2,P3,P_TYPE,P4,P5,P6,P7),
    LINEITEM(L1,P_PARTKEY,L2,L3,L4,L_EXTP,L_DISCOUNT,L5,L6,L7,L_SHIPDATE,L8,L9,L10,L11,L12),
    ((L_SHIPDATE >= '1995-09-01')),
    ((L_SHIPDATE < '1995-10-01')),
    PROV_Q_PRE_0(V2,V3,V0),
    RTPCQ14(V0).

PROV_Q_PRE_0(X,Y,(100 * (X / Y))) :-
    Q1(X,Y).

Q1(sum((CASE  WHEN (P_TYPE LIKE 'PROMO%') THEN (L_EXTP * (1 - L_DISCOUNT)) ELSE 0 END)),sum((L_EXTP * (1 - L_DISCOUNT)))) :-
    PART(P_PARTKEY,P1,P2,P3,P_TYPE,P4,P5,P6,P7),
    LINEITEM(L1,P_PARTKEY,L2,L3,L4,L_EXTP,L_DISCOUNT,L5,L6,L7,L_SHIPDATE,L8,L9,L10,L11,L12),
    ((L_SHIPDATE >= '1995-09-01')),
    ((L_SHIPDATE < '1995-10-01')).

ANS: PROV_LINEITEM.

