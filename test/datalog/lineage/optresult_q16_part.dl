QSIZES(49).
QSIZES(14).
QSIZES(23).
QSIZES(45).
QSIZES(19).
QSIZES(3).
QSIZES(36).
QSIZES(9).

Q(P_BRAND,P_TYPE,P_SIZE,count(S_SUPPKEY)) :-
	QFILTER(P_BRAND,P_TYPE,P_SIZE,S_SUPPKEY),
	QTTLCOM(S_SUPPKEY,0).

RP(X1,X2,X3,X4) :-
	RTPCQ16(X1,X2,X3,X4).

QFILTER(P_BRAND,P_TYPE,P_SIZE,PS_SUPPKEY) :-
	PARTSUPP(P_PARTKEY,PS_SUPPKEY,PS1,PS2,PS3),
	PART(P_PARTKEY,P1,P2,P_BRAND,P_TYPE,P_SIZE,P3,P4,P5),
	QSIZES(P_SIZE),
	((P_BRAND != 'Brand#45')),
	((P_TYPE NOT LIKE 'MEDIUM POLISHED%')).

QTTLCOM(PS_SUPPKEY,sum(CNT)) :-
	QCOMPLAINTS(PS_SUPPKEY,CNT).

QCOMPLAINTS(S_SUPPKEY,1) :-
	SUPPLIER(S_SUPPKEY,S1,S2,S3,S4,S5,S_COMMENT),
	((S_COMMENT LIKE '%Customer%Complaints%')).

QCOMPLAINTS(PS_SUPPKEY,0) :-
	PARTSUPP(V4,PS_SUPPKEY,V5,V6,V7),
	PART(V4,V8,V9,X1,X2,X3,V10,V11,V12),
	QSIZES(X3),
	((X1 != 'Brand#45')),
	((X2 NOT LIKE 'MEDIUM POLISHED%')).

PROV_QFILTER(P_BRAND,P_TYPE,P_SIZE,S_SUPPKEY) :-
	QFILTER(P_BRAND,P_TYPE,P_SIZE,S_SUPPKEY),
	QTTLCOM(S_SUPPKEY,0),
	RP(P_BRAND,P_TYPE,P_SIZE,V1).

PROV_QCOMPLAINTS(PS_SUPPKEY,CNT) :-
	QCOMPLAINTS(PS_SUPPKEY,CNT),
	PROV_QTTLCOM(PS_SUPPKEY,V1).

PROV_QTTLCOM(S_SUPPKEY,0) :-
	QTTLCOM(S_SUPPKEY,0),
	QFILTER(P_BRAND,P_TYPE,P_SIZE,S_SUPPKEY),
	RP(P_BRAND,P_TYPE,P_SIZE,V1).

PROV_PART(P_PARTKEY,P1,P2,P_BRAND,P_TYPE,P_SIZE,P3,P4,P5) :-
	PART(P_PARTKEY,P1,P2,P_BRAND,P_TYPE,P_SIZE,P3,P4,P5),
	PARTSUPP(P_PARTKEY,PS_SUPPKEY,PS1,PS2,PS3),
	((P_BRAND != 'Brand#45')),
	((P_TYPE NOT LIKE 'MEDIUM POLISHED%')),
	PROV_QFILTER(P_BRAND,P_TYPE,P_SIZE,PS_SUPPKEY).

PROV_PART(V4,V8,V9,X1,X2,X3,V10,V11,V12) :-
	PART(V4,V8,V9,X1,X2,X3,V10,V11,V12),
	PARTSUPP(V4,PS_SUPPKEY,V5,V6,V7),
	QSIZES(X3),
	((X1 != 'Brand#45')),
	((X2 NOT LIKE 'MEDIUM POLISHED%')),
	PROV_QCOMPLAINTS(PS_SUPPKEY,V0).

ANS: PROV_PART.
