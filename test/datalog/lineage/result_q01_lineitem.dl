Q(L_RETURN,L_LINESTAT,sum(L_QUANT),sum(L_EXTP),sum((L_EXTP * (1 - L_DISC))),sum(((L_EXTP * (1 - L_DISC)) * (1 + L_TAX))),avg(L_QUANT),avg(L_EXTP),avg(L_DISC),count(X1)) :- LINEITEM(X1,X2,X3,X4,L_QUANT,L_EXTP,L_DISC,L_TAX,L_RETURN,L_LINESTAT,L_SHIPDATE,X5,X6,X7,X8,X9),L_SHIPDATE <= '1998-09-01'.

RP(X1,X2,X3,X4,X5,X6,X7,X8,X9,X10) :- RTPCQ01(X1,X2,X3,X4,X5,X6,X7,X8,X9,X10).

PROV_LINEITEM(X1,X2,X3,X4,L_QUANT,L_EXTP,L_DISC,L_TAX,L_RETURN,L_LINESTAT,L_SHIPDATE,X5,X6,X7,X8,X9) :- LINEITEM(X1,X2,X3,X4,L_QUANT,L_EXTP,L_DISC,L_TAX,L_RETURN,L_LINESTAT,L_SHIPDATE,X5,X6,X7,X8,X9),L_SHIPDATE <= '1998-09-01',RP(L_RETURN,L_LINESTAT,V8,V9,V10,V11,V12,V13,V14,V15).

ANS: PROV_LINEITEM.
