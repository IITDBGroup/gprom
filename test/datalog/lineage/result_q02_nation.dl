Q1(S_ACCOUNT_BAL,S_NAME,N_NAME,P_KEY,S_COST,P_MANU,S_ADDR,S_PHONE,S_COMMENT) :- NATION(N_KEY,N_NAME,R_KEY,X1),REGION(R_KEY,'EUROPE',X2),SUPPLIER(S_KEY,S_NAME,S_ADDR,N_KEY,S_PHONE,S_ACCOUNT_BAL,S_COMMENT),PART(P_KEY,X3,P_MANU,X4,P_TYPE,15,X5,X6,X7),PARTSUPP(P_KEY,S_KEY,X8,S_COST,X9).

Q2(P_KEY,min(S_COST)) :- Q1(X1,X2,X3,P_KEY,S_COST,X5,X6,X7,X8).

Q(S_ACCOUNT_BAL,S_NAME,N_NAME,P_KEY,S_COST,P_MANU,S_ADDR,S_PHONE,S_COMMENT) :- Q1(S_ACCOUNT_BAL,S_NAME,N_NAME,P_KEY,S_COST,P_MANU,S_ADDR,S_PHONE,S_COMMENT),Q2(P_KEY,S_COST).

RP(X1,X2,X3,X4,X5,X6,X7,X8,X9) :- RTPCQ02(X1,X2,X3,X4,X5,X6,X7,X8,X9).

PROV_Q1(X1,X2,X3,P_KEY,S_COST,X5,X6,X7,X8) :- Q1(X1,X2,X3,P_KEY,S_COST,X5,X6,X7,X8),PROV_Q2(P_KEY,V1).

PROV_Q1(S_ACCOUNT_BAL,S_NAME,N_NAME,P_KEY,S_COST,P_MANU,S_ADDR,S_PHONE,S_COMMENT) :- Q1(S_ACCOUNT_BAL,S_NAME,N_NAME,P_KEY,S_COST,P_MANU,S_ADDR,S_PHONE,S_COMMENT),Q2(P_KEY,S_COST),RP(S_ACCOUNT_BAL,S_NAME,N_NAME,P_KEY,S_COST,P_MANU,S_ADDR,S_PHONE,S_COMMENT).

PROV_Q2(P_KEY,S_COST) :- Q1(S_ACCOUNT_BAL,S_NAME,N_NAME,P_KEY,S_COST,P_MANU,S_ADDR,S_PHONE,S_COMMENT),Q2(P_KEY,S_COST),RP(S_ACCOUNT_BAL,S_NAME,N_NAME,P_KEY,S_COST,P_MANU,S_ADDR,S_PHONE,S_COMMENT).

PROV_NATION(N_KEY,N_NAME,R_KEY,X1) :- NATION(N_KEY,N_NAME,R_KEY,X1),REGION(R_KEY,'EUROPE',X2),SUPPLIER(S_KEY,S_NAME,S_ADDR,N_KEY,S_PHONE,S_ACCOUNT_BAL,S_COMMENT),PART(P_KEY,X3,P_MANU,X4,P_TYPE,15,X5,X6,X7),PARTSUPP(P_KEY,S_KEY,X8,S_COST,X9),PROV_Q1(S_ACCOUNT_BAL,S_NAME,N_NAME,P_KEY,S_COST,P_MANU,S_ADDR,S_PHONE,S_COMMENT).

ANS: prov_nation.
