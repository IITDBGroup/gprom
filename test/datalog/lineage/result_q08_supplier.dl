Q2(strftime('%Y', O_ODATE),(L_EXTEND * (1 - L_DISCOUNT)),N_NAME) :- SUPPLIER(S_KEY,X1,X2,S_NKEY,X3,X4,X5),NATION(S_NKEY,N_NAME,X6,X7),CUSTOMER(C_CKEY,X8,X9,C_NKEY,X10,X11,X12,X13),NATION(C_NKEY,X14,N_RKEY,X15),REGION(N_RKEY,'AMERICA',X16),ORDERS(O_OKEY,X17,X18,X19,O_ODATE,X20,X21,X22,X23),LINEITEM(O_OKEY,L_PKEY,S_KEY,X24,X25,L_EXTEND,L_DISCOUNT,X26,X27,X28,X29,X30,X31,X32,X33,X34),PART(L_PKEY,X35,X36,X37,'ECONOMY ANODIZED STEEL',X38,X39,X40,X41),O_ODATE >= '1995-01-01',O_ODATE < '1996-12-31'.

Q1(YEAR,sum((CASE  WHEN (NATION = 'BRAZIL') THEN VOLUME ELSE 0 END)),sum(VOLUME)) :- Q2(YEAR,VOLUME,NATION).

Q(YEAR,(X / Y)) :- Q1(YEAR,X,Y).

RP(X1,X2) :- RTPCQ08(X1,X2).

PROV_Q2(YEAR,VOLUME,NATION) :- Q2(YEAR,VOLUME,NATION),PROV_Q1(YEAR,V2,V3).

PROV_Q1(YEAR,X,Y) :- Q1(YEAR,X,Y),RP(YEAR,V0).

PROV_SUPPLIER(S_KEY,X1,X2,S_NKEY,X3,X4,X5) :- SUPPLIER(S_KEY,X1,X2,S_NKEY,X3,X4,X5),NATION(S_NKEY,N_NAME,X6,X7),CUSTOMER(C_CKEY,X8,X9,C_NKEY,X10,X11,X12,X13),NATION(C_NKEY,X14,N_RKEY,X15),REGION(N_RKEY,'AMERICA',X16),ORDERS(O_OKEY,X17,X18,X19,O_ODATE,X20,X21,X22,X23),LINEITEM(O_OKEY,L_PKEY,S_KEY,X24,X25,L_EXTEND,L_DISCOUNT,X26,X27,X28,X29,X30,X31,X32,X33,X34),PART(L_PKEY,X35,X36,X37,'ECONOMY ANODIZED STEEL',X38,X39,X40,X41),O_ODATE >= '1995-01-01',O_ODATE < '1996-12-31',PROV_Q2(V0,V1,N_NAME).


ANS: PROV_SUPPLIER.
