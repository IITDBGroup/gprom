Q1(N_NAME,strftime('%Y', O_ORDERDATE), ((L_EXTENDEDPRICE * (1 - L_DISCOUNT)) - (PS_SUPPLYCOST * L_QUANTITY))) :-
    PART(P_PARTKEY,P_NAME,X1,X2,X3,X4,X5,X6,X7),
    SUPPLIER(S_SUPPKEY,X8,X9,S_NATIONKEY,X10,X11,X12),
    LINEITEM(L_ORDERKEY,P_PARTKEY,S_SUPPKEY,X13,L_QUANTITY,L_EXTENDEDPRICE,L_DISCOUNT,X14,X15,X16,X17,X18,X19,X20,X21,X22),
    PARTSUPP(P_PARTKEY,S_SUPPKEY,X24,PS_SUPPLYCOST,X25),
    ORDERS(L_ORDERKEY,X26,X27,X28,O_ORDERDATE,X30,X31,X32,X33),
    NATION(S_NATIONKEY,N_NAME,X34,X35),
    ((P_NAME LIKE '%green%')).

Q(NATION,YEAR,sum(AMOUNT)) :- Q1(NATION,YEAR,AMOUNT).

RP(X1,X2,X3) :- RTPCQ09(X1,X2,X3).

PROV_Q1(NATION,YEAR,AMOUNT) :- Q1(NATION,YEAR,AMOUNT),
                               RP(NATION,YEAR,V1).

PROV_LINEITEM(L_ORDERKEY,P_PARTKEY,S_SUPPKEY,X13,L_QUANTITY,L_EXTENDEDPRICE,L_DISCOUNT,X14,X15,X16,X17,X18,X19,X20,X21,X22) :-
    PROV_Q1_PRE_0(L_ORDERKEY,P_PARTKEY,S_SUPPKEY,X13,L_QUANTITY,L_EXTENDEDPRICE,L_DISCOUNT,X14,X15,X16,X17,X18,X19,X20,X21,X22,N_NAME,V0,V1),
    PROV_Q1(N_NAME,V0,V1).

PROV_Q1_PRE_0(L_ORDERKEY,P_PARTKEY,S_SUPPKEY,X13,L_QUANTITY,L_EXTENDEDPRICE,L_DISCOUNT,X14,X15,X16,X17,X18,X19,X20,X21,X22,N_NAME,strftime('%Y', O_ORDERDATE), ((L_EXTENDEDPRICE * (1 - L_DISCOUNT)) - (PS_SUPPLYCOST * L_QUANTITY))) :-
    PART(P_PARTKEY,P_NAME,X1,X2,X3,X4,X5,X6,X7),
    SUPPLIER(S_SUPPKEY,X8,X9,S_NATIONKEY,X10,X11,X12),
    LINEITEM(L_ORDERKEY,P_PARTKEY,S_SUPPKEY,X13,L_QUANTITY,L_EXTENDEDPRICE,L_DISCOUNT,X14,X15,X16,X17,X18,X19,X20,X21,X22),
    PARTSUPP(P_PARTKEY,S_SUPPKEY,X24,PS_SUPPLYCOST,X25),
    ORDERS(L_ORDERKEY,X26,X27,X28,O_ORDERDATE,X30,X31,X32,X33),
    NATION(S_NATIONKEY,N_NAME,X34,X35),
    ((P_NAME LIKE '%green%')).

ANS: PROV_LINEITEM.
