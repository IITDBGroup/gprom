Q1(L_ORDERKEY,sum(L_QUANTITY)) :- LINEITEM(L_ORDERKEY,X1,X2,X3,L_QUANTITY,X4,X5,X6,X7,X8,X9,X10,X11,X12,X13,X14).

Q(C_NAME,C_CUSTKEY,O_ORDERKEY,O_ORDERDATE,O_TOTALPRICE,sum(L_QUANTITY)) :- CUSTOMER(C_CUSTKEY,C_NAME,C1,C2,C3,C4,C5,C6),ORDERS(O_ORDERKEY,C_CUSTKEY,O1,O_TOTALPRICE,O_ORDERDATE,O2,O3,O4,O5),LINEITEM(O_ORDERKEY,X1,X2,X3,L_QUANTITY,X4,X5,X6,X7,X8,X9,X10,X11,X12,X13,X14),Q1(O_ORDERKEY,T1),((T1 > 300)).

RP(X1,X2,X3,X4,X5,X6) :- RTPCQ18(X1,X2,X3,X4,X5,X6).

PROV_Q1(O_ORDERKEY,T1) :- CUSTOMER(C_CUSTKEY,C_NAME,C1,C2,C3,C4,C5,C6),ORDERS(O_ORDERKEY,C_CUSTKEY,O1,O_TOTALPRICE,O_ORDERDATE,O2,O3,O4,O5),LINEITEM(O_ORDERKEY,X1,X2,X3,L_QUANTITY,X4,X5,X6,X7,X8,X9,X10,X11,X12,X13,X14),Q1(O_ORDERKEY,T1),((T1 > 300)),RP(C_NAME,C_CUSTKEY,O_ORDERKEY,O_ORDERDATE,O_TOTALPRICE,V1).

PROV_LINEITEM(L_ORDERKEY,X1,X2,X3,L_QUANTITY,X4,X5,X6,X7,X8,X9,X10,X11,X12,X13,X14) :- LINEITEM(L_ORDERKEY,X1,X2,X3,L_QUANTITY,X4,X5,X6,X7,X8,X9,X10,X11,X12,X13,X14),PROV_Q1(L_ORDERKEY,V1).

PROV_LINEITEM(O_ORDERKEY,X1,X2,X3,L_QUANTITY,X4,X5,X6,X7,X8,X9,X10,X11,X12,X13,X14) :- CUSTOMER(C_CUSTKEY,C_NAME,C1,C2,C3,C4,C5,C6),ORDERS(O_ORDERKEY,C_CUSTKEY,O1,O_TOTALPRICE,O_ORDERDATE,O2,O3,O4,O5),LINEITEM(O_ORDERKEY,X1,X2,X3,L_QUANTITY,X4,X5,X6,X7,X8,X9,X10,X11,X12,X13,X14),Q1(O_ORDERKEY,T1),((T1 > 300)),RP(C_NAME,C_CUSTKEY,O_ORDERKEY,O_ORDERDATE,O_TOTALPRICE,V1).

ANS: PROV_LINEITEM.
