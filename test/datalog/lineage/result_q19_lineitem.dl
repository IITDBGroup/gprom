QQUANTITIES(1,1,11).
QQUANTITIES(2,10,20).
QQUANTITIES(3,20,30).

QPSIZE(1,5).
QPSIZE(2,10).
QPSIZE(3,15).

QBRAND(1,'Brand#12').
QBRAND(2,'Brand#23').
QBRAND(3,'Brand#34').

QCONTAINER(1,'SM CASE').
QCONTAINER(1,'SM BOX').
QCONTAINER(1,'SM PACK').
QCONTAINER(1,'SM PKG').
QCONTAINER(2,'MED BAG').
QCONTAINER(2,'MED BOX').
QCONTAINER(2,'MED PACK').
QCONTAINER(2,'MED PKG').
QCONTAINER(3,'LG CASE').
QCONTAINER(3,'LG BOX').
QCONTAINER(3,'LG PACK').
QCONTAINER(3,'LG PKG').

QSHIPMODES('AIR').
QSHIPMODES('AIR REG').

QOPTIONS(X1,X2,X3,X4,X5) :- QQUANTITIES(ID,X1,X2),
	QCONTAINER(ID,X3),
	QPSIZE(ID,X4),
	QBRAND(ID,X5).

QFILTER(L_ORDERKEY,L_LINENUMBER,L_DISCOUNT,L_EXTP) :-
    LINEITEM(L_ORDERKEY,P_PARTKEY,L2,L_LINENUMBER,L_QUANTITY,L_EXTP,L_DISCOUNT,L4,L5,L6,L7,L8,L9,'DELIVER IN PERSON',L_SHIPMODE,L10),
	PART(P_PARTKEY,P1,P2,P_BRAND,P3,P_SIZE,P_CONTAINER,P4,P5),
	QSHIPMODES(L_SHIPMODE),
	QOPTIONS(Q_LOW,Q_HIGH,P_CONTAINER,P_HIGH,P_BRAND),
	((L_QUANTITY >= Q_LOW)),
	((L_QUANTITY >= Q_HIGH)),
	((P_SIZE >= 1)),
	((P_SIZE <= P_HIGH)).

Q(sum((L_EXTP * (1 - L_DISCOUNT)))) :- QFILTER(L_ORDERKEY,L_LINENUMBER,L_DISCOUNT,L_EXTP).

RP(X1) :- RTPCQ19(X1).

PROV_QFILTER(L_ORDERKEY,L_LINENUMBER,L_DISCOUNT,L_EXTP) :- QFILTER(L_ORDERKEY,L_LINENUMBER,L_DISCOUNT,L_EXTP),
	RP(V1).

PROV_LINEITEM(L_ORDERKEY,P_PARTKEY,L2,L_LINENUMBER,L_QUANTITY,L_EXTP,L_DISCOUNT,L4,L5,L6,L7,L8,L9,'DELIVER IN PERSON',L_SHIPMODE,L10) :-
    LINEITEM(L_ORDERKEY,P_PARTKEY,L2,L_LINENUMBER,L_QUANTITY,L_EXTP,L_DISCOUNT,L4,L5,L6,L7,L8,L9,'DELIVER IN PERSON',L_SHIPMODE,L10),
	PART(P_PARTKEY,P1,P2,P_BRAND,P3,P_SIZE,P_CONTAINER,P4,P5),
	QSHIPMODES(L_SHIPMODE),
	QOPTIONS(Q_LOW,Q_HIGH,P_CONTAINER,P_HIGH,P_BRAND),
	((L_QUANTITY >= Q_LOW)),
	((L_QUANTITY >= Q_HIGH)),
	((P_SIZE >= 1)),
	((P_SIZE <= P_HIGH)),
	PROV_QFILTER(L_ORDERKEY,L_LINENUMBER,L_DISCOUNT,L_EXTP).

ANS: PROV_LINEITEM.
