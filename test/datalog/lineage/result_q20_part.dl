Q1(L_PARTKEY,L_SUPPKEY,sum((0.500000 * L_QUANTITY))) :- LINEITEM(L1,L_PARTKEY,L_SUPPKEY,L2,L_QUANTITY,L3,L4,L5,L6,L7,L_SHIPDATE,L8,L9,L10,L11,L12),((L_SHIPDATE >= '1994-01-01')),((L_SHIPDATE < '1995-01-01')).

Q2(S_SUPPKEY) :- PART(P_PARTKEY,P_NAME,P1,P2,P3,P4,P5,P6,P7),PARTSUPP(P_PARTKEY,S_SUPPKEY,S_AVAILABLE,S1,S2),Q1(P_PARTKEY,S_SUPPKEY,QUANTITY),((S_AVAILABLE > QUANTITY)),((P_NAME LIKE 'forest%')).

Q(S_NAME,S_ADDRESS) :- SUPPLIER(S_SUPPKEY,S_NAME,S_ADDRESS,N_NATIONKEY,S1,S2,S3),NATION(N_NATIONKEY,'CANADA',N1,N2),Q2(S_SUPPKEY).

RP(X1,X2) :- RTPCQ20(X1,X2).

PROV_Q2(S_SUPPKEY) :- SUPPLIER(S_SUPPKEY,S_NAME,S_ADDRESS,N_NATIONKEY,S1,S2,S3),NATION(N_NATIONKEY,'CANADA',N1,N2),Q2(S_SUPPKEY),RP(S_NAME,S_ADDRESS).

PROV_PART(P_PARTKEY,P_NAME,P1,P2,P3,P4,P5,P6,P7) :- PART(P_PARTKEY,P_NAME,P1,P2,P3,P4,P5,P6,P7),PARTSUPP(P_PARTKEY,S_SUPPKEY,S_AVAILABLE,S1,S2),Q1(P_PARTKEY,S_SUPPKEY,QUANTITY),((S_AVAILABLE > QUANTITY)),((P_NAME LIKE 'forest%')),PROV_Q2(S_SUPPKEY).

ANS: PROV_PART.
